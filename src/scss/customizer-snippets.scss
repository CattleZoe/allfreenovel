@import 'common/_functions';
@import 'common/_mixins';

:root.page-style-ringbook:not(.minimal) .main__background {
  filter: var(--layout-main-drop-shadow);

  @include bp(375px) {
    &::before {
      --this-left: #{get_clamp(-14, 0, 375, 768)};
      --this-width: #{get_clamp(22, 26, 375, 768)};
      --mi: url('../img/mask_ringbook.png'), var(--data-image-2x2-black);
      --mp: top 0 left var(--this-left), top 0 left calc(var(--this-width) + var(--this-left) - 1px);
      --ms: var(--this-width) auto, calc(100% - calc(var(--this-width) + var(--this-left) - 1px)) 100%;
      --mr: repeat-y, no-repeat;
      left: 0 !important;

      @include bp(640px) {
        border-radius: 0 var(--layout-border-radius-large) var(--layout-border-radius-large) 1.5rem;
      }
    }
  }
}

:root.page-style-battered:not(.minimal) .main__background {
  filter: var(--layout-main-drop-shadow);

  &::before {
    clip-path: var(--polygon-battered-half);

    @include bp(tablet) {
      left: 4px;
      right: 4px;
      clip-path: var(--polygon-battered);
    }

    @include bp(desktop) {
      left: 0;
      right: 0;
    }
  }
}

:root.page-style-chamfered:not(.minimal) .main__background {
  filter: var(--layout-main-drop-shadow);

  &::before {
    --m: #{get_clamp(6, 12, 320, 768)};

    clip-path: polygon(
      0% var(--m),
      var(--m) 0%,
      calc(100% - var(--m)) 0%,
      100% var(--m),
      100% calc(100% - var(--m)),
      calc(100% - var(--m)) 100%,
      var(--m) 100%,
      0% calc(100% - var(--m))
    );
  }
}

:root.page-style-interface-a:not(.minimal) .main__background {
  filter: var(--layout-main-drop-shadow);

  &::before {
    --o: #{get_clamp(0, 8, 375, 1024)};
    --m: #{get_clamp(6, 8, 320, 768)};
    --g: calc(100% - #{get_clamp(140, 320, 320, 768)});
    --s: #{get_clamp(0, 32, 320, 768)};
    --p: #{get_clamp(92, 230, 320, 768)};
    --i: 0px;

    @include bp(desktop) {
      --i: 4px;
    }

    clip-path: polygon(
      0% calc(var(--o) + var(--m)),
      var(--o) var(--m),

      calc(var(--s)) var(--m),
      calc(var(--m) + var(--s)) 0%,
      calc(var(--m) + var(--s) + var(--p)) 0%,
      calc(2 * var(--m) + var(--s) + var(--p)) var(--m),

      calc(50% - 48px) var(--m),
      calc(50% - 44px) calc(var(--m) + var(--i)),
      calc(50% - 36px) calc(var(--m) + var(--i)),
      calc(50% - 32px) var(--m),

      calc(50% - 16px) var(--m),
      calc(50% - 12px) calc(var(--m) + var(--i)),
      calc(50% - 4px) calc(var(--m) + var(--i)),
      calc(50%) var(--m),

      calc(50% + 16px) var(--m),
      calc(50% + 20px) calc(var(--m) + var(--i)),
      calc(50% + 28px) calc(var(--m) + var(--i)),
      calc(50% + 32px) var(--m),

      var(--g) var(--m),
      calc(var(--g) + 1 * var(--m)) 0%,

      calc(var(--g) + 3 * var(--m)) 0%,
      calc(var(--g) + 2 * var(--m)) var(--m),
      calc(var(--g) + 2.5 * var(--m)) var(--m),
      calc(var(--g) + 3.5 * var(--m)) 0%,

      calc(var(--g) + 5.5 * var(--m)) 0%,
      calc(var(--g) + 4.5 * var(--m)) var(--m),
      calc(var(--g) + 5 * var(--m)) var(--m),
      calc(var(--g) + 6 * var(--m)) 0%,

      calc(var(--g) + 8 * var(--m)) 0%,
      calc(var(--g) + 7 * var(--m)) var(--m),
      calc(var(--g) + 7.5 * var(--m)) var(--m),
      calc(var(--g) + 8.5 * var(--m)) 0%,

      calc(var(--g) + 11 * var(--m)) 0%,
      calc(var(--g) + 11.5 * var(--m)) calc(0.5 * var(--m)),
      calc(100% - 5.5 * var(--m)) calc(0.5 * var(--m)),
      calc(100% - 5 * var(--m)) 0%,

      calc(100% - 1 * var(--m)) 0%,
      100% var(--m),

      100% calc(100% - 1 * var(--m)),
      calc(100% - 1 * var(--m)) 100%,

      var(--m) 100%,
      0% calc(100% - 1 * var(--m))
    );
  }
}

:root.inset-header-image .header-background {
  left: 50%;
  right: unset;
  width: 100%;
  transform: translate3d(-50%, 0, 0);

  @include bp(desktop) {
    border-radius: var(--layout-border-radius-large);
    width: calc(var(--site-width) * 1.5);
    max-width: min(calc(100vw - 2rem), 1980px);
  }

  &__wrapper {
    @include bp(desktop) {
      border-radius: var(--layout-border-radius-large);
    }
  }
}

:root.header-image-style-battered {
  .header-background {
    --layout-header-background-box-shadow: none;
    border-radius: 0 !important;

    &._shadow {
      filter: var(--layout-header-background-drop-shadow);
    }

    &__wrapper {
      border-radius: 0 !important;
      clip-path: var(--polygon-battered-half);

      @include bp(tablet) {
        margin-left: 4px;
        margin-right: 4px;
        clip-path: var(--polygon-battered);
      }

      @include bp(desktop) {
        margin-left: 0;
        margin-right: 0;
      }
    }
  }
}
:root.header-image-style-battered:not(.inset-header-image) {
  .header-background__wrapper {
    --polygon-battered: var(--polygon-battered-half);
    margin-left: 0;
    margin-right: 0;
  }
}

:root:not(.minimal) .content-list-style-full {
  --content-list-item-background: var(--content-list-item-background-full);

  .chapter-group__list-item {
    padding: .5rem 8px .5rem 6px;
  }

  .story__blog-list-item {
    padding: .5rem 8px;
  }

  .card__link-list-item {
    padding-left: 0.35em;
  }
}

:is(:root, :root.minimal) .content-list-style-free {
  --content-list-item-background: none;

  :is(.chapter-group__list-item, .story__blog-list-item) {
    border-radius: 0;
    border-bottom: none;
  }
}

:is(:root, :root.minimal) .content-list-style-lines {
  --content-list-item-background: none;

  :is(.chapter-group__list-item, .story__blog-list-item, .card__link-list-item) {
    border-radius: 0;
    border-bottom: 1.5px solid var(--layout-color-separator);
  }

  .card__link-list-item:last-child {
    border-bottom: none;
  }
}
